<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Job Search</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
    }
    .container {
        max-width: 800px;
        margin: 20px auto;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    .search-params {
        display: flex;
        flex-wrap: wrap;
    }
    .search-params input[type="text"] {
        flex: 1;
        margin-right: 10px;
        margin-bottom: 10px;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    button {
        display: block;
        width: 100%;
        padding: 10px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    .search-results {
        list-style: none;
        padding: 0;
    }
    .search-results li {
        border-bottom: 1px solid #ccc;
        padding: 10px 0;
    }
</style>
</head>
<body>

<div class="container">
    <div class="search-params">
        <input id="jobTitle" type="text" placeholder="Job Name">
        <input id="company" type="text" placeholder="Company">
        <input id="location" type="text" placeholder="Location">
        <input id="publicationDate" type="text" placeholder="Publication Date">
    </div>
    <button id="searchButton" type="button">Search</button>

    <ul id="searchResults" class="search-results">
        <!-- Search results will be displayed here -->
    </ul>
</div>

<script>
document.getElementById("searchButton").addEventListener("click", function() {
    // Get search parameters from input fields
    var title = document.getElementById("jobTitle").value.trim();
    var company = document.getElementById("company").value.trim();
    var location = document.getElementById("location").value.trim();
    var publicationDate = document.getElementById("publicationDate").value.trim();

    // Construct URL with search parameters
    var url = "/api/joblist/?";
    if (title !== "") {
        url += "job_name=" + encodeURIComponent(title) + "&";
    }
    if (company !== "") {
        url += "company=" + encodeURIComponent(company) + "&";
    }
    if (location !== "") {
        url += "location=" + encodeURIComponent(location) + "&";
    }
    if (publicationDate !== "") {
        url += "publication_date=" + encodeURIComponent(publicationDate) + "&";
    }

    // Remove trailing '&' if present
    if (url.slice(-1) === "&") {
        url = url.slice(0, -1);
    }

    // Make AJAX request to API endpoint
    var xhr = new XMLHttpRequest();
    xhr.open("GET", url, true);
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 200) {
            var searchResults = JSON.parse(xhr.responseText);
            displaySearchResults(searchResults);
        }
    };
    xhr.send();
});

function createClickableContainer(jobData) {
    var li = document.createElement("li");
    var jobLink = document.createElement("a");
    jobLink.setAttribute("href", jobData.source_url);
    jobLink.setAttribute("target", "_blank"); // Open link in a new tab
    jobLink.innerHTML = "<h3>" + jobData.job_name + "</h3>" +
                        "<p>" + jobData.company + "</p>" +
                        "<p>" + jobData.job_location + "</p>" +
                        "<p>" + jobData.publication_date + "</p>";
    li.appendChild(jobLink);
    return li;
}

function displaySearchResults(results) {
    var searchResultsElement = document.getElementById("searchResults");
    searchResultsElement.innerHTML = ""; // Clear previous search results

    results.forEach(function(result) {
        var container = createClickableContainer(result);
        searchResultsElement.appendChild(container);
    });
}
</script>

</body>
</html>
